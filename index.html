<!DOCTYPE html>

<html>

<head>
    <title>pixel art attempt
    </title>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="Cache-control" content="no-cache">

    <script src="three.min.js"></script>
    <script src="stats.min.js"></script>
    <script src="WebGL.js"></script>
    <script src="vax.js"></script>
    <script src="OrbitControls.js"></script>
    <script src="three.interaction.js"></script>
    <script src="dat.gui.min.js"></script>
    <!-- <style src="dat-gui-light-theme.css"></style> -->
    <!-- <script src="device-orientation-controls.js"></script> -->
    <!-- <script  src="DeviceOrientationControls.js"></script> -->
</head>

<body>
    <script>

        vaxInit();

        const visible_height = visibleHeightAtZDepth(0, camera);
        const visible_width = visibleWidthAtZDepth(0, camera);
        const box_size_height = visible_height / 25;
        const box_size_width = visible_width / 15;


        createBoxes();
        createInteraction();
        createOrbitControls();

        var gui = new dat.GUI();
        const color_gui = gui.addFolder("Color");
        color_gui.addColor(mesh_params, "color").onChange((color) => {
            mat_pointer.color = hexToRgbThreeJs(color);
        });
        color_gui.add(mesh_params, 'metalness', 0.1, 1).onChange((val) => {
            mat_pointer.metalness = val;
        });
        color_gui.add(mesh_params, 'roughness', 0.1, 1).onChange((val) => {
            mat_pointer.roughness = val;
        });


        var directionalLight = new THREE.DirectionalLight(0xffffff, 1, 100);
        directionalLight.castShadow = true;
        directionalLight.position.set(0, box_size_height * 2, 30);



        scene.add(directionalLight);


        window.addEventListener("deviceorientation", handleOrientation, true);

        function handleOrientation(event) {
            var absolute = event.absolute;
            var alpha = event.alpha;
            var beta = event.beta;
            var gamma = event.gamma;

            pointer.position.x += event.beta;
            pointer.position.y += event.gamma;

            if (pointer.position.x > visible_width - box_size_width) {
                pointer.position.x = visible_width - box_size_width;
            }

            if (pointer.position.y > visible_height - box_size_height) {
                pointer.position.y = visible_height - box_size_height;
            }


            if (pointer.position.x > -visible_width + box_size_width) {
                pointer.position.x = - visible_width + box_size_width;
            }

            if (pointer.position.y > - visible_height + box_size_height) {
                pointer.position.y = -visible_height + box_size_height;
            }
        }

        function animate() {
            pointer.position.z = 7 + 2 * Math.sin(t * 2);
            control.update();

        }
    </script>
</body>

</html>